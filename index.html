<!DOCTYPE html>

<!-- This page is a starting page. It will ask user to login.
 TODO: we should show some general info from weather channel. -->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="help.css">
    <title>TempuTrip</title>

    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>

    <script src="jquery-3.1.0.js"></script>

    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyAXfiPb7lxRd85RpS5WYIIxzwvHvO_ZTOE",
            authDomain: "temputrip.firebaseapp.com",
            databaseURL: "https://TempuTrip.firebaseio.com",
            storageBucket: "temputrip.appspot.com",
            messagingSenderId: "423687763023"
        };

        firebase.initializeApp(config);

        var ref = new Firebase("https://temputrip.firebaseio.com");
     
    
        var todosRef = firebase.database().ref('todos');

        firebase.database().ref('users/ssaad').set({
            username: "sarasaad",
            email: "ssaad2@gmu.edu",
        });

     //Trying to play with the professor's example code 
        var nextIndex = 0;

        todosRef.on('child_added', function (data) {
            createItem(data.val().text, data.key);
        });

        todosRef.on('child_changed', function (data) {
            $('div[data-index="' + data.key + '"] input').val(data.val().text);
        });

        todosRef.on('child_removed', function (data) {
            $('div[data-index="' + data.key + '"]').remove();
        });

        $('#new').click(function () {
            todosRef.push({'text': ""});
        });

        function createItem(value, key) {
            $('#todoItems').append(
                    '<div class="todoItem" data-index="' + key + '"><input type="text" onchange="itemChanged(this)" value="'
                    + value + '"><button onclick="deleteItem(this.parentElement)">&#x2716;</button></div>'
            );
        }

        function deleteItem(inputDiv) {
            todosRef.child(inputDiv.dataset.index).remove();
        }

        function itemChanged(inputElem) {
            var index = inputElem.parentElement.dataset.index;
            todosRef.child(inputElem.parentElement.dataset.index).set({'text': inputElem.value});
        }
    </script>

    <script>
        $(document).ready(function () {
            $("form").submit(function () {
                var val = $("input[type=submit][clicked=true]").val();
                $(location).attr('href', 'Landing.html');
            });

            $("form input[type=submit]").click(function () {
                $("input[type=submit]", $(this).parents("form")).removeAttr("clicked");
                $(this).attr("clicked", "true");
                $(location).attr('href', 'Landing.html');
            });
        });

        function goBack() {
            $("#login").hide().css("visibility", "hidden");
            $("#home").show().css("visibility", "visible");
        }

        function goLogin() {
            $("#home").hide().css("visibility", "hidden");
            $("#login").show().css("visibility", "visible");
        }
     


    </script>

</head>

<body>

<div id="todoItems"></div>

<br/><br/>

<div id="sentiments"></div>

<button onclick="goBack()" id="back">Go Back</button>

<div class="inthe">

    <header>
        <h1 class="center"> Welcome to TempuTrip! </h1>
        <p class="center"><b>The best place to go to find out where to vacation!</b></p>
    </header>

    <div class="center" id="home">
        <p>Please login</p>
        <!--<a href="#" id="next"><img src="image/login.png" alt="login" class="enlargeimage"></a>-->
        <button onclick="goLogin()" id="next"><img src="image/login.png" alt="login" class="enlargeimage"></button>
    </div>

    <div class="center" id="login">
        <p class="center">Simply pick an area and time and we'll tell you where the best place based on weather will be
            to go.</p>
        <form action = "Landing.html"> <!--  action="landing.html" -->

            <label for="email">Your email address:</label>
            <input id="email" name="email" type="email" placeholder="abc@cdf.com">

            <br/>

            <label for="pass">Password:</label>
            <input id="pass" name="pass" type="password">

            <input type="submit" value="login">
             
        <div id="todoItems"></div>
    <button id="submit2">New item</button>
    <button id="save">Save</button>
    <br/><br/>
    <div id="sentiments"></div>  

            
        </form>
     
  
         <script>
        "use strict";
        $('#new').click(function()
        {
            $('#todoItems').append(
                '<div class="todoItem"><input type="text"/><button onclick="deleteItem(this.parentElement)">&#x2716;</button></div>'
            );
        });
        function deleteItem(divElem)
        {
            divElem.parentElement.removeChild(divElem);
        }
        $('#save').click(function()
        {
            var todoItems = [];
            $('.todoItem input').each(function()
            {
                todoItems.push($(this).val());
            });
            $.post("http://127.0.0.1:4000",  { todoItems: todoItems } )
                .done(function(data)
                {
                    $('#sentiments').text(data.sentiments);
                });
        });
    </script>
         
      
    </div>

    <footer>
        <address>
            <p class="center">This site is developed by
                <a href="mailto:sborghei@gmu.edu">Sara Borghei</a>
                and
                <a href="mailto:ssaad2@gmu.edu">Sara Saad</a>
            </p>
        </address>
    </footer>

</div>

</body>

</html>
